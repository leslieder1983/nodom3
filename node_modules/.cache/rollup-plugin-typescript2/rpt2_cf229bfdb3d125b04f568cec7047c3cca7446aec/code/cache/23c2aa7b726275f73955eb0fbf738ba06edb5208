{"code":"import { GlobalCache } from \"./globalcache\";\r\nimport { Util } from \"./util\";\r\n/**\r\n * 事件类\r\n * @remarks\r\n * 事件分为自有事件和代理事件\r\n * @author      yanglei\r\n * @since       1.0\r\n */\r\nexport class NEvent {\r\n    /**\r\n     * @param module        模块\r\n     * @param eventName     事件名\r\n     * @param eventStr      事件串或事件处理函数,以“:”分割,中间不能有空格,结构为: 方法名[:delg(代理到父对象):nopopo(禁止冒泡):once(只执行一次):capture(useCapture)]\r\n     *                      如果为函数，则替代第三个参数\r\n     * @param handler       事件执行函数，如果方法不在module methods中定义，则可以直接申明，eventStr第一个参数失效，即eventStr可以是\":delg:nopopo...\"\r\n     */\r\n    constructor(eventName, eventStr, handler) {\r\n        this.id = Util.genId();\r\n        this.name = eventName;\r\n        GlobalCache.saveEvent(this);\r\n        //如果事件串不为空，则不需要处理\r\n        if (eventStr) {\r\n            let tp = typeof eventStr;\r\n            if (tp === 'string') {\r\n                let eStr = eventStr.trim();\r\n                eStr.split(':').forEach((item, i) => {\r\n                    item = item.trim();\r\n                    if (i === 0) { //事件方法\r\n                        this.handler = item;\r\n                    }\r\n                    else { //事件附加参数\r\n                        switch (item) {\r\n                            case 'delg':\r\n                                this.delg = true;\r\n                                break;\r\n                            case 'nopopo':\r\n                                this.nopopo = true;\r\n                                break;\r\n                            case 'once':\r\n                                this.once = true;\r\n                                break;\r\n                            case 'capture':\r\n                                this.capture = true;\r\n                                break;\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n            else if (tp === 'function') {\r\n                handler = eventStr;\r\n            }\r\n        }\r\n        //新增事件方法（不在methods中定义）\r\n        if (handler) {\r\n            this.handler = handler;\r\n        }\r\n        if (document.ontouchend) { //触屏设备\r\n            switch (this.name) {\r\n                case 'click':\r\n                    this.name = 'tap';\r\n                    break;\r\n                case 'mousedown':\r\n                    this.name = 'touchstart';\r\n                    break;\r\n                case 'mouseup':\r\n                    this.name = 'touchend';\r\n                    break;\r\n                case 'mousemove':\r\n                    this.name = 'touchmove';\r\n                    break;\r\n            }\r\n        }\r\n        else { //转非触屏\r\n            switch (this.name) {\r\n                case 'tap':\r\n                    this.name = 'click';\r\n                    break;\r\n                case 'touchstart':\r\n                    this.name = 'mousedown';\r\n                    break;\r\n                case 'touchend':\r\n                    this.name = 'mouseup';\r\n                    break;\r\n                case 'touchmove':\r\n                    this.name = 'mousemove';\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * 设置附加参数值\r\n     * @param module    模块\r\n     * @param dom       虚拟dom\r\n     * @param name      参数名\r\n     * @param value     参数值\r\n     */\r\n    setParam(module, dom, name, value) {\r\n        module.objectManager.setEventParam(this.id, dom.key, name, value);\r\n    }\r\n    /**\r\n     * 获取附加参数值\r\n     * @param module    模块\r\n     * @param dom       虚拟dom\r\n     * @param name      参数名\r\n     * @returns         参数值\r\n     */\r\n    getParam(module, dom, name) {\r\n        return module.objectManager.getEventParam(this.id, dom.key, name);\r\n    }\r\n    /**\r\n     * 移除参数\r\n     * @param module    模块\r\n     * @param dom       虚拟dom\r\n     * @param name      参数名\r\n     */\r\n    removeParam(module, dom, name) {\r\n        return module.objectManager.removeEventParam(this.id, dom.key, name);\r\n    }\r\n    /**\r\n     * 清参数cache\r\n     * @param module    模块\r\n     * @param dom       虚拟dom\r\n     */\r\n    clearParam(module, dom) {\r\n        module.objectManager.clearEventParam(this.id, dom.key);\r\n    }\r\n}\r\n//# sourceMappingURL=event.js.map","references":["D:/User_zhao/gitRepository/competition/nodom/core/virtualdom.ts","D:/User_zhao/gitRepository/competition/nodom/core/globalcache.ts","D:/User_zhao/gitRepository/competition/nodom/core/model.ts","D:/User_zhao/gitRepository/competition/nodom/core/module.ts","D:/User_zhao/gitRepository/competition/nodom/core/util.ts"],"map":"{\"version\":3,\"file\":\"event.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../core/event.ts\"],\"names\":[],\"mappings\":\"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\"}"}
