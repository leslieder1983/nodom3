{"code":"import { DirectiveManager } from \"./directivemanager\";\r\nimport { Util } from \"./util\";\r\nimport { Expression } from \"./expression\";\r\nimport { NError } from \"./error\";\r\nimport { NodomMessage } from \"./nodom\";\r\n/**\r\n * 指令类\r\n */\r\nexport class Directive {\r\n    /**\r\n     * 构造方法\r\n     * @param type  \t类型名\r\n     * @param value \t指令值\r\n     */\r\n    constructor(type, value) {\r\n        this.id = Util.genId();\r\n        if (type) {\r\n            this.type = DirectiveManager.getType(type);\r\n            if (!this.type) {\r\n                throw new NError('notexist1', NodomMessage.TipWords['directive'], type);\r\n            }\r\n        }\r\n        if (Util.isString(value)) {\r\n            this.value = value.trim();\r\n        }\r\n        else if (value instanceof Expression) {\r\n            this.expression = value;\r\n        }\r\n        else {\r\n            this.value = value;\r\n        }\r\n    }\r\n    /**\r\n     * 执行指令\r\n     * @param module    模块\r\n     * @param dom       渲染目标节点对象\r\n     * @param src       源节点\r\n     * @returns         true/false\r\n     */\r\n    exec(module, dom, src) {\r\n        //禁用，不执行\r\n        if (this.disabled) {\r\n            return true;\r\n        }\r\n        if (this.expression) {\r\n            this.value = this.expression.val(module, dom.model);\r\n        }\r\n        return this.type.handle.apply(this, [module, dom, src]);\r\n    }\r\n    /**\r\n     * 设置参数\r\n     * @param module    模块\r\n     * @param dom       指令对应的虚拟dom\r\n     * @param name      参数名\r\n     * @param value     参数值\r\n     */\r\n    setParam(module, dom, name, value) {\r\n        module.objectManager.setDirectiveParam(this.id, dom.key, name, value);\r\n    }\r\n    /**\r\n     * 获取参数值\r\n     * @param module    模块\r\n     * @param dom       指令对应的虚拟dom\r\n     * @param name      参数名\r\n     * @returns         参数值\r\n     */\r\n    getParam(module, dom, name) {\r\n        return module.objectManager.getDirectiveParam(this.id, dom.key, name);\r\n    }\r\n    /**\r\n     * 移除参数\r\n     * @param module    模块\r\n     * @param dom       指令对应的虚拟dom\r\n     * @param name      参数名\r\n     */\r\n    removeParam(module, dom, name) {\r\n        module.objectManager.removeDirectiveParam(this.id, dom.key, name);\r\n    }\r\n    /**\r\n     * 克隆\r\n     */\r\n    clone() {\r\n        let d = new Directive();\r\n        d.type = this.type;\r\n        d.expression = this.expression;\r\n        d.value = this.value;\r\n        return d;\r\n    }\r\n}\r\n//# sourceMappingURL=directive.js.map","references":["D:/User_zhao/gitRepository/competition/nodom/core/directivemanager.ts","D:/User_zhao/gitRepository/competition/nodom/core/directivetype.ts","D:/User_zhao/gitRepository/competition/nodom/core/virtualdom.ts","D:/User_zhao/gitRepository/competition/nodom/core/module.ts","D:/User_zhao/gitRepository/competition/nodom/core/util.ts","D:/User_zhao/gitRepository/competition/nodom/core/expression.ts","D:/User_zhao/gitRepository/competition/nodom/core/error.ts","D:/User_zhao/gitRepository/competition/nodom/core/nodom.ts"],"map":"{\"version\":3,\"file\":\"directive.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../core/directive.ts\"],\"names\":[],\"mappings\":\"AAAA,OAAO,EAAE,gBAAgB,EAAE,MAAM,oBAAoB,CAAC;AAItD,OAAO,EAAE,IAAI,EAAE,MAAM,QAAQ,CAAC;AAC9B,OAAO,EAAE,UAAU,EAAE,MAAM,cAAc,CAAC;AAC1C,OAAO,EAAE,MAAM,EAAE,MAAM,SAAS,CAAC;AACjC,OAAO,EAAE,YAAY,EAAE,MAAM,SAAS,CAAC;AAEvC;;GAEG;AACH,MAAM,OAAQ,SAAS;IAyBnB;;;;OAIG;IACH,YAAY,IAAY,EAAC,KAAwB;QAC7C,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC,KAAK,EAAE,CAAC;QACvB,IAAG,IAAI,EAAC;YACJ,IAAI,CAAC,IAAI,GAAG,gBAAgB,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;YAC3C,IAAG,CAAC,IAAI,CAAC,IAAI,EAAC;gBACV,MAAM,IAAI,MAAM,CAAC,WAAW,EAAC,YAAY,CAAC,QAAQ,CAAC,WAAW,CAAC,EAAC,IAAI,CAAC,CAAC;aACzE;SACJ;QAED,IAAI,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE;YACtB,IAAI,CAAC,KAAK,GAAY,KAAM,CAAC,IAAI,EAAE,CAAC;SACvC;aAAK,IAAG,KAAK,YAAY,UAAU,EAAC;YACjC,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;SAC3B;aAAI;YACD,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;SACtB;IACL,CAAC;IAED;;;;;;OAMG;IACI,IAAI,CAAC,MAAa,EAAC,GAAO,EAAC,GAAc;QAC5C,QAAQ;QACR,IAAG,IAAI,CAAC,QAAQ,EAAC;YACb,OAAO,IAAI,CAAC;SACf;QACD,IAAG,IAAI,CAAC,UAAU,EAAC;YACf,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,MAAM,EAAC,GAAG,CAAC,KAAK,CAAC,CAAC;SACtD;QACD,OAAO,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,EAAC,CAAC,MAAM,EAAC,GAAG,EAAC,GAAG,CAAC,CAAC,CAAC;IACzD,CAAC;IAED;;;;;;OAMG;IACI,QAAQ,CAAC,MAAa,EAAC,GAAc,EAAC,IAAW,EAAC,KAAS;QAC9D,MAAM,CAAC,aAAa,CAAC,iBAAiB,CAAC,IAAI,CAAC,EAAE,EAAC,GAAG,CAAC,GAAG,EAAC,IAAI,EAAC,KAAK,CAAC,CAAC;IACvE,CAAC;IAED;;;;;;OAMG;IACI,QAAQ,CAAC,MAAa,EAAC,GAAc,EAAC,IAAW;QACpD,OAAO,MAAM,CAAC,aAAa,CAAC,iBAAiB,CAAC,IAAI,CAAC,EAAE,EAAC,GAAG,CAAC,GAAG,EAAC,IAAI,CAAC,CAAC;IACxE,CAAC;IAED;;;;;OAKG;IACI,WAAW,CAAC,MAAa,EAAC,GAAc,EAAC,IAAW;QACvD,MAAM,CAAC,aAAa,CAAC,oBAAoB,CAAC,IAAI,CAAC,EAAE,EAAC,GAAG,CAAC,GAAG,EAAC,IAAI,CAAC,CAAC;IACpE,CAAC;IAED;;OAEG;IACI,KAAK;QACR,IAAI,CAAC,GAAG,IAAI,SAAS,EAAE,CAAC;QACxB,CAAC,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;QACnB,CAAC,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC;QAC/B,CAAC,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;QACrB,OAAO,CAAC,CAAC;IACb,CAAC;CACJ\"}"}
